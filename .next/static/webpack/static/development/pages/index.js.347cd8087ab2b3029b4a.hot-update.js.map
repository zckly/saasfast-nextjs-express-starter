{"version":3,"file":"static/webpack/static/development/pages/index.js.347cd8087ab2b3029b4a.hot-update.js","sources":["webpack:///./static/auth.js"],"sourcesContent":["import Cookie from 'js-cookie';\nimport jwt from 'jsonwebtoken';\nimport fetch from 'isomorphic-unfetch';\nimport * as settings from '../settings';\n\nasync function getJWK() {\n  const res = await fetch(`https://${settings.domain}/.well-known/jwks.json`);\n  const jwk = await res.json();\n  return jwk;\n}\n\nfunction saveToken(token) {\n  Cookie.set('user', token, { expires: 21 });\n};\n\nfunction deleteToken() {\n  Cookie.remove('user');\n};\n\nasync function verifyToken(token) {\n  if (token) {\n    return true\n  }\n  return false\n}\n\nasync function getTokenForBrowser() {\n  return Cookie.getJSON('user');\n}\n\nasync function getTokenForServer(req) {\n  if (req.headers.cookie) {\n    const jwtFromCookie = req.headers.cookie.split(';').find(c => c.trim().startsWith('user='));\n    if (!jwtFromCookie) {\n      return undefined;\n    }\n    const token = jwtFromCookie.split('=')[1];\n    const validToken = await verifyToken(token);\n    if (validToken) {\n      return token;\n    } else {\n      return undefined;\n    }\n  }\n}\n\nexport {\n  saveToken,\n  deleteToken,\n  getTokenForBrowser,\n  getTokenForServer,\n  verifyToken\n};"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AADA;AAAA;AACA;AADA;AAEA;AAFA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;AAMA;AACA;AAAA;AAAA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AADA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;AAOA;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;AAIA;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AAHA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AADA;AAMA;AANA;AAAA;AACA;AADA;AAOA;AACA;AARA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AADA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;A","sourceRoot":""}